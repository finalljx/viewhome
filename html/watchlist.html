<html>
<head>
    <title>安全生产值班表</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1.0"/>
    <link rel="stylesheet" href="../lib/jquery-mobile/jquery.mobile-latest/jquery.mobile.min.css"/>
    <link rel="stylesheet" href="../assets/jquery.mobile-sugon.css"/>
    <script src="../lib/jquery/jquery.min.js"></script>
    <script src="../lib/jquery-cookie/jquery.cookie.js"></script>
    <script src="../lib/encrypt/encrypt.js"></script>
    <script src="../lib/json/json2.js"></script>
    <script src="../lib/hori/hori.js?tag=21369"></script>
    <script src="../lib/arttemplate/template.js"></script>
    <script src="../lib/jquery-mobile/jquery.mobile-latest/jquery.mobile.min.js"></script>
    <script src="../config/web/config.js"></script>
    <style type="text/css">
        .ui-li .ui-btn-inner, .ui-li-static.ui-li {
            padding: .5em 5px;
        }

        .ui-li-desc {
            font-size: 12px;
            font-weight: 100%;
            margin: -.1em 0 .6em;
            font-weight: 400;
            display: block;
            overflow: hidden;
            white-space: nowrap;
        }

        .ui-btn-inner {
            width: 300px;
            height: 60px;
        }

        .ui-field-contain .ui-input-search {
            width: 50%;
            display: inline-block;
        }
    </style>

    <script>
    $(document).ready(function() {
        $.hori.setHeaderTitle("安全生产");
    });

        function doSearch() {
			$.hori.showLoading();
            try {
                var skey = $("#searchKey").val();
                if(skey == null || skey.length == 0){
    				alert("关键词不能为空！");
    				return;
    			} 
                //skey = encodeURI(skey);
                var random = new Date().getTime();
                var cookie_userstore = localStorage.getItem("cookie_userstore");
                var url = $.hori.getconfig().appServerHost + "view/safety/watchList/Application/Safety/SafetyProBasic.nsf/SearchHolidayDutyForMobile?open";
                url = url + "&data-random=" + random + "&data-result=text";
            } catch (e) {
            }
            var data = 'key=' + skey;

            $.hori.ajax({
                "type": "post",
                "url": url,
                "data": data,
                "success": function (res) {
                    var jsonData = new Object();
                    var dataObj = JSON.parse(res);
                    //json {"data":[{"DeptID":"1351","Date":"2013-12-23","StPsnCN":"史海","Dept":"中国仪器进出口(集团)公司","Holiday":"元旦"}]}
                    if(dataObj.flag){
                        var html = template('watchlist',dataObj);
                        $("#listContent").html(html);
                    }else{
                        alert(dataObj.flagMessage);
                    }
					$.hori.hideLoading();
                },
                "error": function (res) {
                    alert(res);
                    $.hori.hideLoading();
                }
            })
        }
        var t1 = null;//这个设置为全局
        //跳转到详情页面
        function loadListDetails(aElement) {
        	if (t1 == null){
                t1 = new Date().getTime();
            }else{       
                var t2 = new Date().getTime();
                if(t2 - t1 < 500){
                    t1 = t2;
                    return;
                }else{
                    t1 = t2;
                }
            }
            $.hori.showLoading();
            var docunid=$(aElement).data("docunid");
            localStorage.setItem("watchDocUnid",docunid);
            $.hori.loadPage($.hori.getconfig().serverBaseUrl + 'viewhome/html/listDetails.html');
        }


    </script>
</head>
<body>

<div data-role="page" class="type-interior">

    <div style="margin-left: 15px;">
        <table>
            <tr>
                <td width="95%" height="20px"><input id="searchKey"
                                                     type="text" value=""/></td>
                <td><a href="#search" data-role="button" data-inline="true"
                       data-rel="dialog" data-corners="true" data-shadow="true"
                       data-iconshadow="true" data-wrapperels="span" data-theme="f"
                       class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c ui-btn-up-f">
							<span class="ui-btn-inner" style="width: 45px; height: 20px;"><span
                                    class="ui-btn-text" style="color: white" onclick="doSearch()">搜索</span></span>
                </a></td>
            </tr>
        </table>
    </div>

    <div data-role="content" id="listContent" style="text-align: center;">
    	<table  cellspacing="0.1" align="center" style="width:100%;font-size: 100%;background-color: white;border:thin solid blue">    	
    	  <tr bordercolor="white" >
    	  <td colspan="3" >集团公司安全生产委员会</td>
    	  </tr>
    	  <tr>
    	  <td width="25%">主任:</td>
    	  <td width="25%">李谠</td>
    	  <td>集团公司总经理</td>
    	  </tr>
    	  <tr>
    	  <td>副主任：</td>
    	  <td>刘大山</td>
    	  <td>集团公司党组成员、副总经理</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>李克全</td>
    	  <td>总经理助理</td>
    	  </tr>
    	  <tr>
    	  <td>委　员：</td>
    	  <td>杨景耀</td>
    	  <td>办公厅主任</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>黄继刚</td>
    	  <td>发展总部副总经理</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>詹　荣</td>
    	  <td>运管总部总经理</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>郑东生</td>
    	  <td>运管总部副总经理</td>
    	  </tr>
    	  <tr>
    	  <td> </td>
    	  <td>徐　明</td>
    	  <td>财务总部总经理</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>钱新荣</td>
    	  <td>人事总部副总经理</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>黄梅艳</td>
    	  <td>风控信息总部总经理</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>欧阳敬芝</td>
    	  <td>党群部副主任（工会副主席）</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>王景林</td>
    	  <td>总务部、物业公司总经理</td>
    	  </tr>
    	  <tr>
    	  <td colspan="3">集团公司安委会联系方式 </td>
    	  </tr>
    	  <tr>
    	  <td>电话： </td>
    	  <td>郑东生</td>
    	  <td>010 - 63349976</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>刘元才</td>
    	  <td>010 - 63349557</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>杨文红</td>
    	  <td>010 - 63349552</td>
    	  </tr>
    	  <tr>
    	  <td></td>
    	  <td>沈德继</td>
    	  <td>010 - 63349562</td>
    	  </tr>
    	  
    	</table>
    </div>

    <script id="watchlist" type="text/html">
		<ul  data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
			{{each data as rowObj i}}
			<li href="#" data-icon="false" class="ui-first-child ui-last-child">
				<a href="javascript:void(0)" data-docunid='{{rowObj["docunid"]}}' onclick="loadListDetails(this)" class="ui-btn">
					<h3 style="white-space: normal;"><span>{{rowObj["Dept"]}}</span></h3>
					<p style="font-size: 14px;line-height: 2em;"> 
						序号：<font color="#0080FF"> {{rowObj["DeptID"]}}</font>
						填报人：<font color="#0080FF"> {{rowObj["StPsnCN"]}}</font><br/>
						填报日期：<font color="#0080FF">{{rowObj["Date"]}}</font>
						节日名称：<font color="#0080FF">{{rowObj["Holiday"]}}</font> 
					</p></a>
			</li>
			{{/each}}
		</ul>
    </script>
    <!-- /page -->
</body>
</html>
