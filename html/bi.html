<html>
<head>
<title>Bi图表</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1.0" />
<link rel="stylesheet" href="../lib/jquery-mobile/jquery.mobile.min.css" />
<link rel="stylesheet" href="../assets/jquery.mobile-sugon.css" />
<link rel="stylesheet" href="../lib/app/home/css/mediaQuery.css">
<script src="../lib/jquery/jquery.min.js"></script>
<script src="../lib/jquery-cookie/jquery.cookie.js"></script>
<script src="../lib/encrypt/encrypt.js"></script>
<script src="../lib/json/json2.js"></script>
<script src="../lib/hori/hori.js?tag=21369"></script>
<script src="../lib/jquery-mobile/jquery.mobile.min.js"></script>
<script src="../config/web/config.js"></script>

<!-- <link rel="stylesheet" href="../lib/app/home/css/news.css"> -->
<script src="../lib/knockout/knockout.js"></script>
<script src="../lib/knockout/knockout.mapping.js"></script>

<script type="text/javascript">
	var currentUser = "";
	$(document).ready(function() {
		$.hori.setHeaderTitle("经营数据");
		var allData = [ {
			'reportId' : 1,
			'title' : '经营态势',
			'target' : 'bi/jyts.html',
			'img' : '../assets/home/jyts.png'
		}, {
			'reportId' : 6,
			'title' : '收入利润趋势',
			'target' : 'bi/srlrqs.html',
			'img' : '../assets/home/srlrqs.png'
		}, {
			'reportId' : 11,
			'title' : '收入完成',
			'target' : 'bi/srwc.html',
			'img' : '../assets/home/srwc.png'
		}, {
			'reportId' : 16,
			'title' : '利润完成',
			'target' : 'bi/lrwc.html',
			'img' : '../assets/home/lrwc.png'
		},

		{
			'reportId' : 21,
			'title' : '风险状况',
			'target' : 'bi/fxzk.html',
			'img' : '../assets/home/fxzk.png'
		}, {
			'reportId' : 31,
			'title' : '收入板块',
			'target' : 'bi/srbk.html',
			'img' : '../assets/home/srbk.png'
		}, {
			'reportId' : 36,
			'title' : '利润板块',
			'target' : 'bi/lrbk.html',
			'img' : '../assets/home/lrbk.png'
		}, {
			'reportId' : 66,
			'title' : '收入利润',
			'target' : 'bi/srlr.html',
			'img' : '../assets/home/srlr.png'
		} ];
		var jsondata = localStorage.getItem("bi_modules");
		var json = JSON.parse(jsondata);
		var target=[];
		for (var i = 0; i < json.length; i++) {
			for (var j = 0; j < allData.length; j++) {
				if (json[i].reportId == allData[j].reportId){
					target.push(allData[j]); 
					break;
					}
			}

		}
		var data = new Object();
		data.list = target;
		render(data);
		try {
			var hori = $.hori;
		} catch (e) {
			alert(e.message);
		}
	});

	function render(jsonData) {
		var viewModel = ko.mapping.fromJS(jsonData);
		ko.applyBindings(viewModel,document.getElementById("divBi"));
	}
	//点击进入详情页面
	function loadBi(item) {
		var url=item.target();
		$.hori.loadPage($.hori.getconfig().serverBaseUrl
						+ "viewhome/html/"+url);
	}
</script>
<style>
.module-icon {
	width: 5em;
	height: 5em;
}
</style>
</head>
<body>
<div data-role="content" align="center">
		<div class="ui-grid-b" id="divBi">
		<div data-bind="foreach: list" style="width:100%;">
			<div class="ui-block-b divxs">
				<a  data-bind="click:loadBi" > <img
					id="imgToDo" class="imgToDo module-icon" data-bind="attr:{'src':img}" class="module-icon"/>
				</a> <br /> 
				<span style="color: #434343;" ><strong data-bind="text:title"></strong></span>
			</div>
			</div>
		</div>
	</div>
</body>
</html>
