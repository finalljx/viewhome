<html>
<head>
<title>安全生产值班表详情</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1.0" />
<link rel="stylesheet"
	href="../lib/jquery-mobile/jquery.mobile-latest/jquery.mobile.min.css" />
<link rel="stylesheet" href="../assets/jquery.mobile-sugon.css" />
<link href="../lib/jquery-mobile/jquery-mobile-fluid960.css"
	rel="stylesheet" />
<script src="../lib/encrypt/encrypt.js"></script>
<script src="../lib/json/json2.js"></script>
<script src="../lib/hori/hori.js?tag=21369"></script>
<script src="../config/web/config.js"></script>

<script>
	var viewModel = new Object();

	$(document)
			.ready(
					function() {
						try {
							$.hori.hideLoading();
							$.hori.loading();
							$.hori.setHeaderTitle("安全生产值班表详情");
							var config = $.hori.getconfig();
							var docunid = localStorage.getItem("watchDocUnid");
							var serverUrl = $.hori.getconfig().appServerHost;
							var dataSource = "view/safety/detail/Application/Safety/SafetyProBasic.nsf/loadAppContentForMobile?openagent&data-result=text&docunid="
									+ docunid;
							serverUrl = serverUrl + dataSource;

							
							$.hori
									.ajax({
										"type" : "get",
										"url" : serverUrl,
										"dataType" : "json",

										"success" : function(res) {
											
											var parsedStr = JSON.parse(res);

											render(parsedStr);
											var reg = /((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/g;
											var rep = '<a href="tel:$1" style="">$1</a>';
											var exp = $(
													'#divO ul:first')
													.html();
											exp = exp.replace(reg, rep);
											$('#divO ul:first')
													.html(exp);
											$.hori.loading('hide');
											
										},
										"error" : function(res) {
											alert("error" + res);
											$.hori.hideLoading();
										}
									});
						} catch (e) {
							alert(e.message);
						}
					});

	function render(parsedStr) {
		viewModel = ko.mapping.fromJS(parsedStr);
		ko.applyBindings(viewModel, document.getElementById('divO'));
	}
</script>
</head>
<body>

	<div id="notice" data-role="page" data-url="notice" tabindex="0"
		class="ui-page ui-body-c ui-page-active"
		style="height: 100%; margin: 5px;">
		<div data-role="content" align="center" class="ui-content" role="main">
			<div data-role="content" class="ui-content" role="main" id='divO'
				style='font-weight: bold;'>
				<h3>节日（重大活动）期间安全生产及值班安排表</h3>
				<ul data-role="listview" data-inset="true" data-theme="d"
					id="ul_dtable_list"
					class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
					<li data-role="list-divider" role="heading"
						class="ui-li ui-li-divider ui-bar-b ui-first-child">值班信息</li>
					<li id="div_DTblHtml"
						class="ui-li ui-li-static ui-btn-up-d ui-last-child">




						<ul data-role="listview" data-inset="true" data-theme="d"
							class="ui-listview ui-listview-inset ui-corner-all ui-shadow"
							data-bind='foreach: schedules.data'>

							<li class="ui-li ui-li-static ui-btn-up-d ui-first-child">值班时间
								：<span data-bind='text: column1'></span>
							</li>

							<li class="ui-li ui-li-static ui-btn-up-d">值班领导 ：<span
								data-bind='text: column2'></span></li>

							<li class="ui-li ui-li-static ui-btn-up-d">联系电话 ：<span
								data-bind='text: column3'></span></li>

							<li class="ui-li ui-li-static ui-btn-up-d">值班员 ：<span
								data-bind='text: column4'></span></li>

							<li class="ui-li ui-li-static ui-btn-up-d ui-last-child">联系电话
								：<span data-bind='text: column5'></span>
							</li>

						</ul>

					</li>
				</ul>
				<ul data-role="listview" data-inset="true" data-theme="d"
					class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
					<li data-role="list-divider" role="heading"
						class="ui-li ui-li-divider ui-bar-b ui-first-child">节假日期间生产安排情况</li>
					<li class="ui-li ui-li-static ui-btn-up-d ui-last-child"
						style='white-space: normal;' data-bind='text: holsit'></li>
				</ul>
				<ul data-role="listview" data-inset="true" data-theme="d"
					class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
					<li data-role="list-divider" role="heading"
						class="ui-li ui-li-divider ui-bar-b ui-first-child">安全保证措施</li>
					<li class="ui-li ui-li-static ui-btn-up-d ui-last-child"
						style='white-space: normal;' data-bind='text: safety'></li>
				</ul>
			</div>
		</div>
	</div>
</body>
</html>